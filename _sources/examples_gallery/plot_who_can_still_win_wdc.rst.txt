
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples_gallery/plot_who_can_still_win_wdc.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_gallery_plot_who_can_still_win_wdc.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_gallery_plot_who_can_still_win_wdc.py:

Who can still win the drivers WDC?
======================================

Calculates which drivers still has chance to win the WDC.
Simplified since it doesn't compare positions if points are equal.

This example implements 3 functions that it then uses to calculate
it's result.

.. GENERATED FROM PYTHON SOURCE LINES 10-17

.. code-block:: default


    import requests
    import fastf1

    fastf1.Cache.enable_cache("../doc_cache")  # replace with your cache directory









.. GENERATED FROM PYTHON SOURCE LINES 18-21

We need a function to get the current driver standings from
Ergast and returns as list of drivers.
Reference https://ergast.com/mrd/methods/standings/

.. GENERATED FROM PYTHON SOURCE LINES 21-29

.. code-block:: default

    def get_drivers_standings():
        url = "https://ergast.com/api/f1/current/driverStandings.json"
        response = requests.get(url)
        data = response.json()
        drivers_standings = data['MRData']['StandingsTable']['StandingsLists'][0]['DriverStandings']  # noqa: E501
        return drivers_standings









.. GENERATED FROM PYTHON SOURCE LINES 30-33

We need a function to calculates the maximum amount of points possible if a
driver wins everything left of the season.
https://en.wikipedia.org/wiki/List_of_Formula_One_World_Championship_points_scoring_systems

.. GENERATED FROM PYTHON SOURCE LINES 33-51

.. code-block:: default

    def calculate_max_points_for_remaining_season():
        POINTS_FOR_SPRINT = 8 + 25 + 1  # Winning the sprint, race and fastest lap
        POINTS_FOR_CONVENTIONAL = 25 + 1  # Winning the race and fastest lap

        events = fastf1.events.get_events_remaining()
        # Count how many sprints and conventional races are left
        sprint_events = \
            len(events.loc[events["EventFormat"] == "sprint"])
        conventional_events = \
            len(events.loc[events["EventFormat"] == "conventional"])

        # Calculate points for each
        sprint_points = sprint_events * POINTS_FOR_SPRINT
        conventional_points = conventional_events * POINTS_FOR_CONVENTIONAL

        return sprint_points + conventional_points









.. GENERATED FROM PYTHON SOURCE LINES 52-58

For each driver we will see if there is a chance to get more points than
the current leader. We assume the leader gets no more points and the
driver gets the theoretical maximum amount of points.

We currently don't consider the case of two drivers getting equal points
since its more complicated and would require comparing positions.

.. GENERATED FROM PYTHON SOURCE LINES 58-72

.. code-block:: default

    def calculate_who_can_win(driver_standings, max_points):
        LEADER_POINTS = int(driver_standings[0]['points'])

        for _, driver in enumerate(driver_standings):
            driver_max_points = int(driver["points"]) + max_points
            can_win = 'No' if driver_max_points < LEADER_POINTS else 'Yes'

            print(f"{driver['position']}: \
    {driver['Driver']['code']}, \
    Current points: {driver['points']}, \
    Theoretical max points: {driver_max_points}, \
    Can win: {can_win}")









.. GENERATED FROM PYTHON SOURCE LINES 73-75

Now using the 3 functions above we can use them to calculate who
can still win.

.. GENERATED FROM PYTHON SOURCE LINES 75-84

.. code-block:: default


    # Get the current drivers standings
    driver_standings = get_drivers_standings()

    # Get the maximum amount of points
    points = calculate_max_points_for_remaining_season()

    # Print which drivers can still win
    calculate_who_can_win(driver_standings, points)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    1: VER, Current points: 258, Theoretical max points: 500, Can win: Yes
    2: LEC, Current points: 178, Theoretical max points: 420, Can win: Yes
    3: PER, Current points: 173, Theoretical max points: 415, Can win: Yes
    4: RUS, Current points: 158, Theoretical max points: 400, Can win: Yes
    5: SAI, Current points: 156, Theoretical max points: 398, Can win: Yes
    6: HAM, Current points: 146, Theoretical max points: 388, Can win: Yes
    7: NOR, Current points: 76, Theoretical max points: 318, Can win: Yes
    8: OCO, Current points: 58, Theoretical max points: 300, Can win: Yes
    9: BOT, Current points: 46, Theoretical max points: 288, Can win: Yes
    10: ALO, Current points: 41, Theoretical max points: 283, Can win: Yes
    11: MAG, Current points: 22, Theoretical max points: 264, Can win: Yes
    12: RIC, Current points: 19, Theoretical max points: 261, Can win: Yes
    13: GAS, Current points: 16, Theoretical max points: 258, Can win: Yes
    14: VET, Current points: 16, Theoretical max points: 258, Can win: Yes
    15: MSC, Current points: 12, Theoretical max points: 254, Can win: No
    16: TSU, Current points: 11, Theoretical max points: 253, Can win: No
    17: ZHO, Current points: 5, Theoretical max points: 247, Can win: No
    18: STR, Current points: 4, Theoretical max points: 246, Can win: No
    19: ALB, Current points: 3, Theoretical max points: 245, Can win: No
    20: LAT, Current points: 0, Theoretical max points: 242, Can win: No
    21: HUL, Current points: 0, Theoretical max points: 242, Can win: No





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.409 seconds)


.. _sphx_glr_download_examples_gallery_plot_who_can_still_win_wdc.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_who_can_still_win_wdc.py <plot_who_can_still_win_wdc.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_who_can_still_win_wdc.ipynb <plot_who_can_still_win_wdc.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
