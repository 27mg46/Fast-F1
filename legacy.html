

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>fastf1.legacy - Provides access to legacy functionality &mdash; Fast F1 2.1.6 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Time, Date and Timing - Explanation" href="time_explanation.html" />
    <link rel="prev" title="fastf1.livetiming - Live Timing Client" href="livetiming.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Fast F1
          

          
          </a>

          
            
            
              <div class="version">
                2.1.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/theOehrly/Fast-F1">← Back to Github</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="fastf1.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="fastf1.html#getting-started">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="fastf1.html#package-functions">Package functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.core</span></code> - Core module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core.html#data-objects">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#api-reference">API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="core.html#id1">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="core.html#get-session">get_session</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.html#get-round">get_round</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="core.html#id2">Data Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="core.html#weekend">Weekend</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.html#session">Session</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.html#laps">Laps</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.html#lap">Lap</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.html#telemetry">Telemetry</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.html#driver">Driver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="core.html#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.api</span></code> - Api module</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.utils</span></code> - Utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.plotting</span></code> - Plotting module</a></li>
<li class="toctree-l1"><a class="reference internal" href="livetiming.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.livetiming</span></code> - Live Timing Client</a><ul>
<li class="toctree-l2"><a class="reference internal" href="livetiming.html#usage-example">Usage Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="livetiming.html#important-notes">Important Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="livetiming.html#command-line-interface">Command Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="livetiming.html#save">Save</a></li>
<li class="toctree-l3"><a class="reference internal" href="livetiming.html#extract">Extract</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="livetiming.html#module-fastf1.livetiming.client">Live Timing Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="livetiming.html#module-fastf1.livetiming.data">Live Timing Data Object</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.legacy</span></code> - Provides access to legacy functionality</a></li>
</ul>
<p class="caption"><span class="caption-text">Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="time_explanation.html">Time, Date and Timing - Explanation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="time_explanation.html#points-in-time">Points in Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_explanation.html#lap-timing">Lap timing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="howto_accurate_calculations.html">How to perform calculations accurately</a><ul>
<li class="toctree-l2"><a class="reference internal" href="howto_accurate_calculations.html#validating-results">Validating results</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto_accurate_calculations.html#working-with-the-available-data">Working with the available data</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto_accurate_calculations.html#slicing-data-by-lap-for-use-in-further-calculations">Slicing data by lap for use in further calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto_accurate_calculations.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="known_bugs.html">Known bugs and caveats</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#something-doesn-t-work">Something doesn’t work</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-1-6-added-weather-data-general-improvements-and-bug-fixes">v2.1.6 Added weather data, general improvements and bug fixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-1-5-improved-robustness-and-minor-fixes">v2.1.5 Improved robustness and minor fixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-1-4-bug-fixes-and-various-minor-improvements">v2.1.4 Bug fixes and various minor improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-1-3-improved-error-handling">v2.1.3 Improved error handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-1-2-hotfixes-for-loading-live-timing-data">v2.1.2 Hotfixes for loading live timing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-1-1-add-support-for-recording-and-using-live-timing-data">v2.1.1 Add support for recording and using live timing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-1-refactoring-accuracy-improvements-and-a-more-accessible-interface">v2.1: Refactoring, accuracy improvements and a more accessible interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-0-2-api-code-overhaul">v2.0.2: API code overhaul</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-0-1-integration-of-a-newer-version-of-ax6-s-old-repository">v2.0.1: Integration of a newer version of Ax6’s old repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v2-0-0-first-release-of-this-fork">v2.0.0: first release of this fork</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v1-5-1-last-release-by-ax6">v1.5.1: last release by Ax6</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Fast F1</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.legacy</span></code> - Provides access to legacy functionality</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/legacy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-fastf1.legacy"></span><div class="section" id="fastf1-legacy-provides-access-to-legacy-functionality">
<h1><a class="reference internal" href="#module-fastf1.legacy" title="fastf1.legacy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fastf1.legacy</span></code></a> - Provides access to legacy functionality<a class="headerlink" href="#fastf1-legacy-provides-access-to-legacy-functionality" title="Permalink to this headline">¶</a></h1>
<p>This module contains the legacy implementation for calculating distance to driver ahead.</p>
<p><a class="reference internal" href="#fastf1.legacy.inject_driver_ahead" title="fastf1.legacy.inject_driver_ahead"><code class="xref py py-func docutils literal notranslate"><span class="pre">inject_driver_ahead()</span></code></a> adds ‘DriverAhead’ and ‘DistanceToDriverAhead’ to the position data for all laps of all
drivers. This functionality has been replaced with <a class="reference internal" href="core.html#fastf1.core.Telemetry.add_driver_ahead" title="fastf1.core.Telemetry.add_driver_ahead"><code class="xref py py-func docutils literal notranslate"><span class="pre">fastf1.core.Telemetry.add_driver_ahead()</span></code></a>.
The new implementation provides smoother and more accurate results. Additionally, it can be applied to arbitrary slices
of data. But it suffers from integration error when used over multiple laps. The legacy implementation has no
integration error issues.</p>
<p>It is recommended to use the new version. If necessary, it should be applied lap
by lap and the lap data should be concatenated afterwards. Still, the old version can be used if so desired.</p>
<p>The following is an example comparison plot of the legacy version and the new version. It also shows how the two
versions can be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fastf1</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fastf1</span><span class="o">.</span><span class="n">Cache</span><span class="o">.</span><span class="n">enable_cache</span><span class="p">(</span><span class="s2">&quot;test_cache/&quot;</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fastf1</span><span class="o">.</span><span class="n">get_session</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="n">laps</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">load_laps</span><span class="p">(</span><span class="n">with_telemetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">DRIVER</span> <span class="o">=</span> <span class="s1">&#39;VER&#39;</span>  <span class="c1"># which driver; need to specify number and abbreviation</span>
<span class="n">DRIVER_NUMBER</span> <span class="o">=</span> <span class="s1">&#39;33&#39;</span>
<span class="n">LAP_N</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># which lap number to plot</span>

<span class="n">drv_laps</span> <span class="o">=</span> <span class="n">laps</span><span class="o">.</span><span class="n">pick_driver</span><span class="p">(</span><span class="n">DRIVER</span><span class="p">)</span>
<span class="n">drv_lap</span> <span class="o">=</span> <span class="n">drv_laps</span><span class="p">[(</span><span class="n">drv_laps</span><span class="p">[</span><span class="s1">&#39;LapNumber&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">LAP_N</span><span class="p">)]</span>  <span class="c1"># select the lap</span>


<span class="c1"># define a function for plotting &#39;DistanceToDriverAhead&#39; over &#39;SessionTime&#39; for varying drivers ahead</span>
<span class="k">def</span> <span class="nf">plot_ahead_over_distance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">suffix</span><span class="p">):</span>
    <span class="n">drvs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DriverAhead&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">drv</span> <span class="ow">in</span> <span class="n">drvs</span><span class="p">:</span>  <span class="c1"># plot a segment for each driver ahead</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DriverAhead&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">drv</span>
        <span class="n">dist_to_drv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DistanceToDriverAhead&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">mask</span><span class="p">)</span>
        <span class="n">ref_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SessionTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">mask</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref_time</span><span class="p">,</span> <span class="n">dist_to_drv</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">drv</span><span class="p">)</span><span class="o">+</span><span class="n">suffix</span><span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>

<span class="c1"># ############### new</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">drv_lap</span><span class="o">.</span><span class="n">get_car_data</span><span class="p">()</span><span class="o">.</span><span class="n">add_driver_ahead</span><span class="p">()</span>
<span class="n">plot_ahead_over_distance</span><span class="p">(</span><span class="n">df_new</span><span class="p">,</span> <span class="s1">&#39;_new&#39;</span><span class="p">)</span>

<span class="c1"># ############### legacy</span>
<span class="n">df_legacy</span> <span class="o">=</span> <span class="n">fastf1</span><span class="o">.</span><span class="n">legacy</span><span class="o">.</span><span class="n">inject_driver_ahead</span><span class="p">(</span><span class="n">session</span><span class="p">)[</span><span class="n">DRIVER_NUMBER</span><span class="p">]</span><span class="o">.</span><span class="n">slice_by_lap</span><span class="p">(</span><span class="n">drv_lap</span><span class="p">)</span>
<span class="n">plot_ahead_over_distance</span><span class="p">(</span><span class="n">df_legacy</span><span class="p">,</span> <span class="s1">&#39;_legacy&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="_static/dist_ahead_new_legacy.svg"><img alt="_images/dist_ahead_new_legacy.svg" src="_images/dist_ahead_new_legacy.svg" /></a>
<dl class="py data">
<dt id="fastf1.legacy.REFERENCE_LAP_RESOLUTION">
<code class="sig-prename descclassname"><span class="pre">fastf1.legacy.</span></code><code class="sig-name descname"><span class="pre">REFERENCE_LAP_RESOLUTION</span></code><em class="property"> <span class="pre">=</span> <span class="pre">0.667</span></em><a class="headerlink" href="#fastf1.legacy.REFERENCE_LAP_RESOLUTION" title="Permalink to this definition">¶</a></dt>
<dd><p>A distance in meters which indicates the resolution of the reference
lap. This reference is used to project car positions and calculate
things like distance between cars.</p>
</dd></dl>

<dl class="py function">
<dt id="fastf1.legacy.inject_driver_ahead">
<code class="sig-prename descclassname"><span class="pre">fastf1.legacy.</span></code><code class="sig-name descname"><span class="pre">inject_driver_ahead</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastf1/legacy.html#inject_driver_ahead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fastf1.legacy.inject_driver_ahead" title="Permalink to this definition">¶</a></dt>
<dd><p>Add ‘DistanceToDriverAhead’ and ‘DriverAhead’ column to position data of all drivers in session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>session</strong> – <a class="reference internal" href="core.html#fastf1.core.Session" title="fastf1.core.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">fastf1.core.Session</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing <a class="reference internal" href="core.html#fastf1.core.Telemetry" title="fastf1.core.Telemetry"><code class="xref py py-class docutils literal notranslate"><span class="pre">fastf1.core.Telemetry</span></code></a> for each driver. The telemetry is the same as
<a class="reference internal" href="core.html#fastf1.core.Session.pos_data" title="fastf1.core.Session.pos_data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">fastf1.core.Session.pos_data</span></code></a> but with ‘DriverAhead’ and ‘DistanceToDriverAhead’ columns added
to each drivers telemetry.</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="time_explanation.html" class="btn btn-neutral float-right" title="Time, Date and Timing - Explanation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="livetiming.html" class="btn btn-neutral float-left" title="fastf1.livetiming - Live Timing Client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, theOehrly.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>